<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Description • HockeyModel</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model Description">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HockeyModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model-description.html">Model Description</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pbulsink/HockeyModel">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Model Description</h1>
                        <h4 class="author">Philip Bulsink</h4>
            
            <h4 class="date">2019-01-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/pbulsink/HockeyModel/blob/master/vignettes/model-description.Rmd"><code>vignettes/model-description.Rmd</code></a></small>
      <div class="hidden name"><code>model-description.Rmd</code></div>

    </div>

    
    
<div id="hockey-model-description" class="section level1">
<h1 class="hasAnchor">
<a href="#hockey-model-description" class="anchor"></a>Hockey Model Description</h1>
<p>This season is the first season of my hockey model, currently lacking a cool name. The model is very simple, using Dixon-Coles’ (DC) method for predicting the outcome of sports games. DC predictions were first described for soccer (football) and are commonly used in that domain.</p>
<p>The method uses strength of scoring and defense (plus a home ice advantage term) to predict a expected goals for away and home teams, and then modifies the results to enhance the prevalance of low-scoring games. Using a poisson distribution, the density of expected total goals for home and away can be summed to produce a win percent. I then apply a factor to enhance the number of tie games, as the model under-predicts ties since it doesn’t understand the tendancy to play for the loser point.</p>
<div id="model-details" class="section level2">
<h2 class="hasAnchor">
<a href="#model-details" class="anchor"></a>Model Details</h2>
<p>Much of the groundwork for this model was by <a href="http://opisthokonta.net/?p=939">OpisThokonta</a> in his 2014 series on Dixon-Coles for his blog. For each team, the attack and defense parameters are compared to the goals scored and allowed against each other team in each game. Optimization of these attack and defense parameters produces values that pass the smell test:</p>
<p><img src="https://github.com/pbulsink/HockeyModel/raw/master/prediction_results/graphics/current_rating.png" width="679px" height="525px" style="display: block; margin: auto;"></p>
<p>In addition, a home team enhancement and low-scoring parameters are produced. More information on the code particulars can be seen <a href="https://pbulsink.github.io/blog/2016-08-05/dixon_coles_and_hockey_data.html">in my blog</a> from a few years ago. Topics such as past game weights and low-scoring adjustments are covered there.</p>
<p>The attack, defense and home parameters are blended together to produce a matrix of outcome probabilities, with the odds that a specific score (e.g. 3-2 for the home team) will occur. The odds of a home team win, then, are the sum of all the odd shwere the home team has a higher score. Similar simple sums show us odds of away win or a ‘draw’.</p>
<div id="draws" class="section level3">
<h3 class="hasAnchor">
<a href="#draws" class="anchor"></a>Draws</h3>
<p>The model tends to inherently under-predict draws. Improving this (by a similar method as low scoring adjustments) is in the plans, but not being actively developed. In the mean time, draws are artificially enhanced by a simple ratio adjustment, bringing draws towards an average probability of draws in the last year. Of course, some games will still have higher or lower probabilities, but this adjustment brings odds of a draw from ~0.18 to ~0.23.</p>
<p>Draws are predicted without opinion to the outcome. However, games don’t end in a tie. The daily predictions that are posted show instead an odds that the home or away teams will win in OT/SO. These odds are found by splitting the draw odds by the ratio of Home to Away win odds. Simply, if a draw was predicted at 0.2 odds, the home team expected win was 0.5, and away win was 0.3, then the home ot/so win would be 0.2 x (0.5/0.8) = 0.125, and the away odds the remainder (0.075).</p>
</div>
</div>
<div id="predictions" class="section level2">
<h2 class="hasAnchor">
<a href="#predictions" class="anchor"></a>Predictions</h2>
<p>Each game is predicted using the model, producing a simple prediction output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/todayDC.html">todayDC</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">'2018-10-03'</span>))
<span class="co">#&gt;              HomeTeam           AwayTeam   HomeWin   AwayWin      Draw</span>
<span class="co">#&gt; 1     San Jose Sharks      Anaheim Ducks 0.5444681 0.2335950 0.2219369</span>
<span class="co">#&gt; 2 Toronto Maple Leafs Montreal Canadiens 0.5461145 0.2392482 0.2146373</span>
<span class="co">#&gt; 3   Vancouver Canucks     Calgary Flames 0.3353522 0.4349142 0.2297337</span>
<span class="co">#&gt; 4 Washington Capitals      Boston Bruins 0.4403726 0.3207246 0.2389028</span></code></pre></div>
<p>Each game remaining in the season is fed into a Monte-Carlo simulation run 10^{5} times, with a result (home win, home OT, home SO, away SO, away OT, away win) generated by a random number generator for each game in each season repeated. At the end of each season, the total points produced, whether or not a team made the playoffs, and presidents’ trophy winners are calculated. These are averaged over all of the simulations to produce the daily predictions, which are posted on Twitter.</p>
<p><img src="https://pbs.twimg.com/media/DwEfH3EV4AA6Ct0.jpg:large" width="679px" height="525px" style="display: block; margin: auto;"></p>
<p>After the daily predictions are posted, the model moves through each game that day posting the expected goals plots for the two teams. The odds of each number of goals is the horizontal or vertical sum of the row/column in the matrix generated by the prediction engine.</p>
<p><img src="https://pbs.twimg.com/media/DwZvRrOV4AA7b57.jpg:large" width="679px" height="525px" style="display: block; margin: auto;"></p>
<p>Periodically, the Twitter bot also plots pace plots, showing how each team is doing relative to their original prediction.</p>
<p><img src="https://pbs.twimg.com/media/Dv4SOCCUYAAW2Z9.jpg:large" width="679px" height="525px" style="display: block; margin: auto;"></p>
</div>
<div id="performance" class="section level2">
<h2 class="hasAnchor">
<a href="#performance" class="anchor"></a>Performance</h2>
<p>As of Jan 03, 2018, the model produced a Log Loss of 0.6888 and accuracy of 59.0 %. These are results from 614 games (approximately 1/2 season).</p>
</div>
<div id="code-availability" class="section level2">
<h2 class="hasAnchor">
<a href="#code-availability" class="anchor"></a>Code Availability</h2>
<p>The code for all of this is available on <a href="https://www.github.com/pbulsink/HockeyModel">GitHub</a>. Ancillary tools are there too, including work not included in the model focusing on ELO rankings of teams.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#hockey-model-description">Hockey Model Description</a><ul class="nav nav-pills nav-stacked">
<li><a href="#model-details">Model Details</a></li>
      <li><a href="#predictions">Predictions</a></li>
      <li><a href="#performance">Performance</a></li>
      <li><a href="#code-availability">Code Availability</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Philip bulsink.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
